<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <title>Loading...</title>

    <title id="seo_title">Loading...</title>

    <!-- ‚úÖ Meta Tags with Unique IDs -->
    <meta id="meta-description" name="description" content="Default description" />
    <meta id="meta-keywords" name="keywords" content="Default, Keywords" />
    <link id="canonical-link" rel="canonical" href="https://yourwebsite.com/default" />

    <!-- ‚úÖ Open Graph (OG) Meta Tags -->
    <meta id="og-title" property="og:title" content="Default OG Title" />
    <meta id="og-description" property="og:description" content="Default OG Description" />
    <meta id="og-image" property="og:image" content="https://yourwebsite.com/default.jpg" />
    <meta id="og-url" property="og:url" content="https://yourwebsite.com/default" />
    <meta id="og-type" property="og:type" content="article" />

    <!-- ‚úÖ Twitter Meta Tags -->
    <meta id="twitter-card" name="twitter:card" content="summary_large_image" />
    <meta id="twitter-title" name="twitter:title" content="Default Twitter Title" />
    <meta id="twitter-description" name="twitter:description" content="Default Twitter Description" />
    <meta id="twitter-image" name="twitter:image" content="https://yourwebsite.com/default.jpg" />

    <!-- ‚úÖ Schema Markup (Will be updated dynamically) -->
    <script id="seo-schema" type="application/ld+json"></script>
    <!-- Default title before update -->
    <meta name="google-site-verification" content="LO-FU93rGZj3KmFKZEv_2Y_ve61QkGZh4C9nDDrxhxg" />

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/css/bootstrap.min.css" />
    <!-- Favicons -->
    <link href="assets/img/port (2).jpg" rel="icon" />
    <link href="assets/img/port (2).jpg" rel="apple-touch-icon" />

    <!-- Fonts -->
    <link href="https://fonts.googleapis.com" rel="preconnect" />
    <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin />

    <!-- SEO Meta Tags -->
    <meta
      name="description"
      content="Detailed blog post by Nabin Chhetri. Read more about various topics and insights."
    />
    <meta name="author" content="Nabin Chhetri" />
    <meta name="keywords" content="Nabin Chhetri, blog, detailed blog, insights, articles" />
    <meta property="og:title" content="Blog Details by Nabin Chhetri" />
    <meta
      property="og:description"
      content="Detailed blog post by Nabin Chhetri. Read more about various topics and insights."
    />
    <meta property="og:image" content="assets/img/port (2).jpg" />
    <meta property="og:type" content="article" />
    <meta property="og:url" content="https://yourwebsite.com/blog-details" />
    <link
      href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&family=Raleway:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap"
      rel="stylesheet"
    />
    <script src="https://unpkg.com/@tailwindcss/browser@4"></script>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-icons/1.10.5/font/bootstrap-icons.min.css"
    />

    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  </head>
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-EGF2WF62EY"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() {
      dataLayer.push(arguments);
    }
    gtag("js", new Date());

    gtag("config", "G-EGF2WF62EY");
  </script>

  <body class="bg-gray-100 text-gray-900">
    <nav class="bg-white shadow-md fixed top-0 left-0 w-full z-50">
      <div class="container mx-auto flex items-center justify-between p-4">
        <a href="/" class="text-2xl font-bold text-gray-800">Nabin's Blog</a>

        <!-- Desktop Menu -->
        <div class="hidden md:flex space-x-6">
          <a href="/" class="text-gray-700 hover:text-blue-500">üè† Home</a>
          <a href="/blogs.html" class="text-gray-700 hover:text-blue-500">üìù Blog</a>
        </div>

        <!-- Mobile Menu Button -->
        <i id="nav-toggle" class="text-2xl cursor-pointer md:hidden bi bi-list"></i>
      </div>

      <!-- Mobile Menu (Hidden by default) -->
      <div id="mobile-menu" class="hidden bg-white md:hidden flex flex-col items-center space-y-4 py-4 shadow-md">
        <a href="/" class="text-gray-700 hover:text-blue-500">üè† Home</a>
        <a href="/blog" class="text-gray-700 hover:text-blue-500">üìù Blog</a>
      </div>
    </nav>

    <div class="container mx-auto flex flex-col items-center justify-center mt-20 bg-white p-6 rounded-lg shadow-lg">
      <div class="w-20 h-20 bg-gray-300 rounded-full overflow-hidden">
        <img
          src="https://scontent.fktm17-1.fna.fbcdn.net/v/t39.30808-6/474557024_1317787036080635_4359964698648288199_n.jpg?_nc_cat=102&ccb=1-7&_nc_sid=a5f93a&_nc_eui2=AeGu2IEzcRw_u-0TtyAxhpbdtr0m0KmDVTi2vSbQqYNVOEbGrVy-6V2zrjlor0KOhcNCdKBlHT4NxE2m0frLUgFW&_nc_ohc=iukaYdXMs2UQ7kNvgFMBnal&_nc_oc=AdgjxVD_kpzIzyD9qlSJ5mFkYbdZQLQgOJV-0Q_BXBWy0Q-UsleygPjjCWqDMVPsIoU&_nc_zt=23&_nc_ht=scontent.fktm17-1.fna&_nc_gid=Ay7KwxtT-iJJjCOD-ANb_nQ&oh=00_AYC_m256PJiaJbWzLr4n_FMKzkFOub0MA5LeMi3-fXMCLQ&oe=67A3BC91"
          alt="Nabin's Avatar"
          class="w-full h-full object-cover rounded-full"
        />
      </div>
      <div class="text-lg font-semibold mt-4 text-gray-800">Hello, I'm Nabin. Welcome to my blog! üöÄ</div>
    </div>

    <!-- Blog Container -->
    <div class="container mx-auto mt-20 px-4">
      <!-- Blog Banner -->
      <div class="relative w-full rounded-lg overflow-hidden shadow-lg group">
        <!-- Background Image -->
        <img
          id="blog-banner"
          src=""
          alt="Blog Banner"
          class="w-full h-72 md:h-96 object-cover transition-transform duration-500 group-hover:scale-105"
        />

        <!-- Overlay (Gradient for Readability) -->
        <div class="absolute inset-0 bg-gradient-to-b from-black/50 to-black/80"></div>

        <!-- Blog Title & Meta -->
        <div class="absolute inset-0 flex flex-col items-center justify-center text-center text-white p-6">
          <h1 id="blog-title" class="text-3xl md:text-5xl font-bold drop-shadow-lg">Loading...</h1>
          <p id="blog-meta" class="text-sm md:text-lg text-gray-200 mt-2 drop-shadow-md">
            Published on: ... | Views: ...
          </p>
        </div>
      </div>

      <!-- Breadcrumb -->
      <div class="flex flex-wrap items-center space-x-1 sm:space-x-2 bg-white shadow-md p-3 rounded-lg">
        <!-- Home -->
        <a
          href="/"
          class="flex items-center px-3 sm:px-4 py-2 bg-gray-100 text-gray-600 font-medium rounded-l-lg hover:bg-gray-200 transition"
        >
          <i class="fas fa-home mr-1 sm:mr-2"></i> <span class="hidden sm:inline">Home</span>
        </a>

        <!-- Blog -->
        <div class="flex items-center">
          <div
            class="w-0 h-0 border-l-[8px] sm:border-l-[10px] border-l-gray-100 border-t-[12px] sm:border-t-[16px] border-t-transparent border-b-[12px] sm:border-b-[16px] border-b-transparent"
          ></div>
          <a
            href="/blogs.html"
            class="px-3 sm:px-4 py-2 bg-gray-100 text-gray-600 font-medium hover:bg-gray-200 transition"
            >Blog</a
          >
        </div>

        <!-- Blog Slug (Dynamic) -->
        <div class="flex items-center">
          <div
            class="w-0 h-0 border-l-[8px] sm:border-l-[10px] border-l-gray-100 border-t-[12px] sm:border-t-[16px] border-t-transparent border-b-[12px] sm:border-b-[16px] border-b-transparent"
          ></div>
          <span id="blog-slug" class="px-3 sm:px-4 py-2 bg-gray-100 text-gray-600 font-medium rounded-r-lg"
            >Loading...</span
          >
        </div>
      </div>

      <!-- Blog Content -->
      <div class="container mx-auto mt-10 px-4 grid grid-cols-1 md:grid-cols-3 gap-6">
        <!-- Left Column: Blog Content -->
        <div class="md:col-span-2 bg-white p-6 rounded-lg shadow-md">
          <h1 id="blog-title" class="text-3xl font-bold text-gray-800"></h1>
          <p id="blog-meta" class="text-gray-500 mt-2"></p>

          <img id="blog-image" src="" alt="Blog Image" class="w-full h-80 object-cover rounded-lg mt-4" />

          <div id="blog-content" class="mt-6 text-gray-700 leading-7"></div>
        </div>

        <!-- Right Column: Related Blogs -->
        <div class="bg-white p-6 rounded-lg shadow-md">
          <h2 class="text-xl font-semibold text-gray-800 mb-4">üì¢ Related Blogs</h2>
          <div id="related-blogs" class="space-y-4">
            <!-- Related blogs will be added here dynamically -->
          </div>
        </div>
      </div>
    </div>

    <!-- Scroll to Top Button -->
    <a href="#" id="scroll-top" class="fixed bottom-6 right-6 bg-gray-800 text-white p-3 rounded-full shadow-md hidden">
      <i class="bi bi-arrow-up-short text-2xl"></i>
    </a>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <script>
      $(document).ready(function () {
        let urlParams = new URLSearchParams(window.location.search);
        let slug = urlParams.get("slug");

        if (!slug) {
          $("body").html("<p class='text-red-500 text-center mt-10'>Blog not found!</p>");
          return;
        }

        console.log("Fetching blog for slug:", slug);

        // Fetch main blog content
        $.ajax({
          url: `https://merochiya.com/api/blog/${slug}`,
          method: "GET",
          dataType: "json",
          success: function (response) {
            if (!response.status || !response.data) {
              $("body").html("<p class='text-red-500 text-center mt-10'>Blog not found!</p>");
              return;
            }

            let blog = response.data;
            console.log("Blog fetched:", blog.seo_title);

            // ‚úÖ Fix Title Update
            document.title = blog.seo_title; // Correct way to update <title>

            $("#blog-image").attr("src", blog.image);
            $("#blog-banner").attr("src", blog.banner);
            $("#blog-title").text(blog.name);
            $("#blog-slug").text(blog.slug);
            $("#blog-meta").text(
              `Published on: ${new Date(blog.created_at).toDateString()} | Views: ${blog.post_view}`
            );
            $("#blog-content").html(blog.description);

            // Fetch related blogs
            fetchRelatedBlogs(slug);
          },
          error: function (xhr, status, error) {
            console.log("AJAX Error:", xhr.responseText);
            $("body").html("<p class='text-red-500 text-center mt-10'>Failed to load blog details.</p>");
          },
        });

        // Function to fetch related blogs
        function fetchRelatedBlogs(currentSlug) {
          $.ajax({
            url: "https://merochiya.com/api/blogs",
            method: "GET",
            dataType: "json",
            success: function (response) {
              let blogs = response.data || [];
              let relatedHtml = "";

              blogs.forEach(function (blog) {
                if (blog.slug !== currentSlug) {
                  // Exclude current blog
                  relatedHtml += `
                            <a href="blog-details.html?slug=${blog.slug}"
                               class="flex items-center space-x-4 p-3 bg-gray-100 rounded-lg hover:bg-gray-200 transition">
                                <img src="${blog.image}" alt="${blog.name}"
                                     class="w-16 h-16 object-cover rounded-lg">
                                <div>
                                    <h5 class="text-sm font-semibold text-gray-800">${blog.name}</h5>
                                    <p class="text-xs text-gray-500">üìÖ ${new Date(blog.created_at).toDateString()}</p>
                                </div>
                            </a>
                        `;
                }
              });

              $("#related-blogs").html(relatedHtml);
            },
            error: function (error) {
              console.log("Error fetching related blogs:", error);
              $("#related-blogs").html("<p class='text-red-500'>Failed to load related blogs.</p>");
            },
          });
        }
      });

      // Mobile Menu Toggle
      document.getElementById("nav-toggle").addEventListener("click", function () {
        document.getElementById("mobile-menu").classList.toggle("hidden");
      });
    </script>
  </body>
</html>
